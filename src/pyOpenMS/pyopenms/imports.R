library(reticulate)
library(R6)
library(purrr)
listDepth <- plotrix::listDepth
check.numeric <- varhandle::check.numeric
Pymod <- reticulate::import("pyopenms")
reticulate::py_run_string("import gc")
copy <- reticulate::import("copy")
py_builtin <- reticulate::import_builtins(convert = F)

# R6 class object conversion to python class object.
`r_to_py.R6` <- function(i,...){
   tryCatch({
       i$.__enclos_env__$private$py_obj
   }, error = function(e) { "conversion not supported for this class"}
   )
}

# python function to convert a python dict having byte type key to R named list with names as string.
py_run_string(paste("def transform_dict(d):","    return dict(zip([k.decode('utf-8') for k in d.keys()], d.values()))",sep = "\n"))

# Returns the name of wrapper R6 class
class_to_wrap <- function(py_ob){
       class <- tail(strsplit(class(py_ob)[1],"\\.")[[1]],n = 1)
       # To correctly return the class name for Interfaces (BinaryDataArray,Chromatogram,Spectrum) by removing "_Interfaces_"
       comp <- strsplit(class,"_Interfaces_")[[1]]
       if (length(comp) == 1 && comp[1] == class){
           return(class)
       }
       else { return(comp[-1]) }
} 
