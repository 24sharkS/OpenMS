# Universal Windows Platform
# Build a Universal Windows Platform project using Visual Studio.
# Add steps that test and distribute an app, save build artifacts, and more:
# https://aka.ms/yaml

trigger:
- master

pool:
  vmImage: 'windows-latest'

steps:
  - task: UsePythonVersion@0
    inputs:
      versionSpec: '3.6'

  - script: python -m pip install --upgrade pip setuptools wheel
    displayName: 'Install tools'

  - script: python -m pip install requests semantic_version lxml
    displayName: 'Install tools2'

  - task: Bash@3
    condition: false
    inputs:
      targetType: 'inline'
      script: 
        cd .. &&
        mkdir -p contrib_build &&
        curl https://abibuilder.informatik.uni-tuebingen.de/archive/openms/contrib/windows/x64/msvc-15/contrib_build.tar.gz -s -o contrib_build.tar.gz &&
        tar xzf contrib_build.tar.gz &&
        ls -la &&
        rm contrib_build.tar.gz
    displayName: Download and extract contrib

  - task: Bash@3
    inputs:
      targetType: 'inline'
      script: 
        cd .. &&
        git clone https://github.com/ads00/qt-downloader &&
        chmod +x qt-downloader/qt-downloader &&
        ./qt-downloader/qt-downloader windows desktop 5.12.6 win64_msvc2015_64 &&
        ls -la
    displayName: Install QT

  - task: Bash@3
    condition: false
    inputs:
      targetType: 'inline'
      script: 
        cd .. 
        mkdir -p build
        cmake
    displayName: Run CMake
    
